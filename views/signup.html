<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Chat app - Signup</title>


<link rel="stylesheet" href="/css/style.css">

</head>

<body>

<div class="container">

  <div class="card">

    <div class="card-header">
      Chat app
    </div>

    <div class="card-body">

      <form id="signupForm">

        <div class="form-group">
          <label>Username</label>
          <input name="username" placeholder="username" required>
        </div>

        <div class="form-group">
          <label>First Name</label>
          <input name="firstname" placeholder="firstname" required>
        </div>

        <div class="form-group">
          <label>Last Name</label>
          <input name="lastname" placeholder="lastname" required>
        </div>

        <div class="form-group">
          <label>Password</label>
          <input name="password" type="password" placeholder="password" required>
        </div>

        <button type="submit" class="btn">
          Create Account
        </button>

      </form>

      <p id="msg" class="msg"></p>

      <a href="/login" class="link">
        Go to Login
      </a>

    </div>

  </div>

</div>

<script>

document.getElementById("signupForm")
.addEventListener("submit", async (e)=>{

  e.preventDefault();

  const form = new FormData(e.target);
  const body = Object.fromEntries(form.entries());

  const res = await fetch("/api/signup",{
    method:"POST",
    headers:{
      "Content-Type":"application/json"
    },
    body:JSON.stringify(body)
  });

  const data = await res.json();

  document.getElementById("msg").innerText =
    data.message || "Done";

  if(res.ok){
    window.location.href="/login";
  }

});

</script>

</body>
</html>
